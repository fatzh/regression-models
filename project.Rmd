---
title: "Regrssion models - Course Project"
author: "Fabrice Tereszkiewciz"
date: "16 Oct 2015"
output: pdf_document
---

```{r global_options, include=FALSE}
library(knitr)
read_chunk('./project.R')
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```

```{r, include=FALSE}
<<loadPackages>>
<<loadData>>
```

## Introduction

You work for Motor Trend, a magazine about the automobile industry. Looking at a data set of a collection of cars, they are interested in exploring the relationship between a set of variables and miles per gallon (MPG) (outcome). They are particularly interested in the following two questions.

## Executive summary


## Exploratory Analysis

```{r}
<<exploAnalysis>>
```

The dataset contains 32 observations and 11 variables. 

```{r, fig.height=4, fig.align='center'}
<<exploplot>>
g
```

This plot shows the MPG values increasing for the manual transmissions.

## Inference

To first determin if the transmission has an impact on the MPG, let $H_{0}$ be the null hypothesis that it has no impact : $H_{0} : \mu _{auto} = \mu _{manual}$

```{r}
<<inference>>
```

The variance difference is not negligible, we will assume the 2 groups to have unequal variance for the T test.

```{r}
t.test(mpg ~ am, data=mtcars, paired=FALSE, var.equal=FALSE)
```

As the 95% interval is `[-11.28 -3.21]` doesn't contain 0 and the P-value is < 0.5, the hypothesis that the transmission is not important can be rejected.

## Regression

We can try a marginal linear regression first to see the effect of the transmission type on MPG, holding all other variables constant.

```{r}
<<MTlm>>
```

We can see that on average manual transmission vehicules can do 7.245 miles per gallon more than automatic transmission vehicules. Looking at the R-squared error, we can see that only `r round(summary(mdl.mar)$r.squared * 100, 2)`% of the variance in MPG is explained by the type of transmission. We must therefore look at other variables in order to explain the MPG change.

We can do a step search to find the most optimal model to fit the MPG value.

```{r, results="hide"}
<<stepSearch>>
```
```{r}
summary(mdl.opt)
```

The MPG can be better explained by including the weight (`wt`), horse power (`hp`), and cylinder 16 and 8 (`cyl16`, `cyl18`) to the model. With this model, a manual transmission increases the MPG by 1.81 holding all other variables constant.

```{r}
anova(mdl.mar, mdl.opt)
```

The P-value is highly significant (almost 0), which confirms that the model `mdl.opt` is more accurate than the marginal model `mdl.mar`.

## Residuals and Diagnostics

The plots are in appendix :

- there are no signs of correlation between the residuals and fitted values, which is good for a  in a homoscedastic linear model with normally distributed errors.
- the QQ plot support normality of the residuals, as all points are close to the line.
- the points look randomly distributed on the Scale-Location plot, so we can assume constant variance.
- all the residuals are well away from the 0.5 Cook's distance, which doesn't indicate any proble with excessive leverage.

# Appendix

## Models diagnostic

```{r, fig.width=10, fig.height=8}
<<plotDiagModelOptimal>>
```